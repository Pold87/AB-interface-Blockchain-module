FROM ethereum/client-go

RUN apk add --update git bash nodejs nodejs-npm perl python make g++ nano

RUN cd /root/ &&\
    git clone https://github.com/cubedro/eth-net-intelligence-api &&\
    cd eth-net-intelligence-api
#RUN apt-get update
#RUN apt-get install --yes --fix-missing software-properties-common
#RUN add-apt-repository ppa:ethereum/ethereum
#RUN apt-get update && apt-get install --yes --fix-missing ethereum solc

RUN npm -g config set user root
RUN npm install &&\
    npm install -g pm2

RUN npm install solc --unsafe &&\
    npm install web3 --unsafe &&\
    npm install web3-ipc --unsafe

ADD start.sh /root/start.sh
RUN chmod +x /root/start.sh
ADD app.json /root/eth-net-intelligence-api/app.json
ADD Voting.sol /root/Voting.sol
ADD query.js /root/query.js
Add deploy.js /root/deploy.js
Add mydeploy.js /root/mydeploy.js
Add smart_contract_threshold.sol /root/smart_contract_threshold.sol
Add get_enode.sh /root/get_enode.sh
ADD exec_cmd.sh /root/exec_cmd.sh

ENTRYPOINT tail -f /dev/null #/root/start.sh

# Use this line to save time (i.e., you don't need to create the DAG)
#ADD dag/full-R23-0000000000000000 /root/.ethash/full-R23-0000000000000000


